SQL TOPICS 
SQL(Structured Query Language):-> The sql is used to store,retrieve,update and manage data in a relational database
SYNTAX:->SELECT COLUMN_NAME FROM TABLE_NAME
EXAMPLE->SELECT * FROM EMPLOYEE;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DBMS VS RDBMS
DBMS:
1)DBMS(Database Management System) is used to store data in file
2)no relationships is used
3)slower
RDBMS:
1)RDBMS(Relational Database Management System) is used to store data in tables
2)RDBMS uses table with relationship using keys.
3)Faster
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Table,Row,Column:
1)Table:->It is used to store collection of datas in rows and columns.
2)Rows:-> It is a one complete record in a table.
3)Columns:-> It is a one attribute of the data.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Keys in SQL:
1)Primary key:
A primary key is used to identify each record in a table and it cannot be null.
Example:
CREATE TABLE EMPLOYEE(
      E_ID INT Primary Key,
      E_name varchar(20)
);
2)Foreign key:
A foreign key refers to the primary key of another table.
Example:
FOREIGN KEY (E_depid) REFERENCES Department(E_depid)
3)Candidate key:
A column that can be a primary key is called Candidate key.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1)SELECT:
SELECT is used to retrieve the data from the table
SYNTAX:-> SELECT * FROM TABLE_NAME;
2)WHERE:
WHERE is used to filter the records based on condition.
SYNTAX:-> SELECT * FROM TABLE_NAME WHERE CONDITION
3)DISTINCT:
DISTINCT is used to remove duplicate values in a result.
SYNTAX:-> SELECT DISTINCT COLUMN_NAME FROM TABLE_NAME
4)ORDER BY:
ORDER BY is used to sort the records in asc or desc
SYNTAX:-> SELECT COLUMN_NAME FROM TABLE_NAME ORDER BY COLUMN_NAME ASC|DESC
5)LIMIT:
LIMIT is used to return the number of records returned.
SYNTAX:-> SELECT * FROM EMPLOYEES LIMIT 5;
6)ALIAS:
ALIAS is used to set a temporary name to a column or a table.
SYNTAX:-> SELECT COLUMN_NAME AS COLUMN_NAME1 FROM TABLE_NAME;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Practice:
Customers table:
customer_id	first_name	last_name	age	country
     1	John	      Doe	      31	USA
     2	Robert	Luna	      22	USA
     3	David	      Robinson    22	UK 
     4	John	      Reinhardt   25	UK
     5	Betty	      Doe	      28	UAE
Orders table:
order_id	item	      amount	customer_id
     1	Keyboard	400	      4
     2	Mouse	      300	      4
     3	Monitor	12000	      3
     4	Keyboard	400	      1
     5	Mousepad	250	      2
Shippings table:
shipping_id	status	customer
     1	Pending	2
     2	Pending	4
     3	Delivered	3 
     4	Pending	5
     5	Delivered	1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BASIC SELECT
Q1ï¸âƒ£ Display all customer details from the Customers table. -------------> select * from Customers;

Q2ï¸âƒ£ Display only first_name and country of all customers.  -------------> select first_name,country from Customers;

Q3ï¸âƒ£ Fetch all records from Orders table.                   -------------> select * from Orders;

Q4ï¸âƒ£ Display order_id, item, amount from Orders.            -------------> select order_id,item,amount from Orders;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
WHERE (Filtering)
Q5ï¸âƒ£ Display customers whose age is greater than 25.        -------------> select * from Customers where age>25;

Q6ï¸âƒ£ Find customers from USA.                               -------------> select * from Customers where country='USA';

Q7ï¸âƒ£ Display orders where amount is greater than 500.       -------------> select * from Orders where amount>500;

Q8ï¸âƒ£ Display shipping details where status is Pending.      -------------> select * from Shippings where status='Pending';
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DISTINCT (Remove Duplicates)
Q9ï¸âƒ£ Display unique countries from Customers table.         -------------> select distinct country from Customers;

Q1ï¸âƒ£0ï¸âƒ£ Display distinct ages of customers.                  -------------> select distinct age from Customers;

Q1ï¸âƒ£1ï¸âƒ£ Display distinct items ordered in Orders table.      -------------> select distinct item from Orders;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ORDER BY (Sorting)
Q1ï¸âƒ£2ï¸âƒ£ Display customers sorted by age in ascending order.  -------------> select * from Customers order by age asc;

Q1ï¸âƒ£3ï¸âƒ£ Display customers sorted by age in descending order. -------------> select * from Customers order by age desc;

Q1ï¸âƒ£4ï¸âƒ£ Display orders sorted by amount (highest to lowest). -------------> select * from Orders order by amount desc;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LIMIT / TOP
Q1ï¸âƒ£5ï¸âƒ£ Display top 3 customers from Customers table.        -------------> select * from Customers limit 3;

Q1ï¸âƒ£6ï¸âƒ£ Display top 2 highest amount orders.                 -------------> select * from Orders order by amount desc limit 2;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ALIAS
Q1ï¸âƒ£7ï¸âƒ£ Display first_name as Name and country as Nation.    -------------> select first_name as Name ,country as Nation from Customers;

Q1ï¸âƒ£8ï¸âƒ£ Display amount as Total_Amount from Orders table.    -------------> select amount as Total_Amount from Orders;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
COMBINED PRACTICE (DAY 1 LEVEL)
Q1ï¸âƒ£9ï¸âƒ£ Display customers from UK, sorted by age.            -------------> select * from Customers where country='UK' order by age desc;

Q2ï¸âƒ£0ï¸âƒ£ Display orders with amount greater than 300, sorted by amount. ---> select * from Orders where amount>300 order by amount asc; 

Q2ï¸âƒ£1ï¸âƒ£ Display unique customer ages, sorted in descending order. --------> select distinct age from Customers order by age desc;

Q2ï¸âƒ£2ï¸âƒ£ Display first 2 pending shippings.                   -------------> select * from Shippings where status ='Pending' order by shipping_id limit 2;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ AGGREGATE FUNCTIONS
Q1ï¸âƒ£ Count the total number of customers.                    -------------> select count(*) from Customers;                   

Q2ï¸âƒ£ Find the total amount of all orders.                    -------------> select sum(amount) from Orders

Q3ï¸âƒ£ Find the average age of customers.                      -------------> select avg(age) from Customers

Q4ï¸âƒ£ Find the minimum order amount.                          -------------> select min(amount) from Orders

Q5ï¸âƒ£ Find the maximum order amount.                          -------------> select max(amount) from Orders
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ WHERE + AGGREGATES
Q6ï¸âƒ£ Count the number of customers from USA.                       -------------> select count(*) from Customers where country = 'USA';

Q7ï¸âƒ£ Find the total order amount for orders where amount is greater than 300. --> select sum(amount) from Orders where amount>300;

Q8ï¸âƒ£ Find the average age of customers from UK.                    -------------> select avg(age) from Customers where country='UK';
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ðŸ”¹ IN OPERATOR
Q9ï¸âƒ£ Display customers who belong to USA or UK.                    -------------> select * from Customers where country in ('UK','USA');

Q1ï¸âƒ£0ï¸âƒ£ Display orders where item is Keyboard or Mouse.             -------------> select * from Orders where item in ('Keyboard','Mouse');
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ BETWEEN OPERATOR
Q1ï¸âƒ£1ï¸âƒ£ Display customers whose age is between 22 and 30.           -------------> select * from Customers where age between 22 and 30;

Q1ï¸âƒ£2ï¸âƒ£ Display orders where amount is between 300 and 1000.        -------------> select * from Orders where amount between 300 and 1000;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ LIKE OPERATOR
Q1ï¸âƒ£3ï¸âƒ£ Display customers whose first_name starts with 'J'.         -------------> select * from Customers where first_name like 'J%';

Q1ï¸âƒ£4ï¸âƒ£ Display customers whose last_name ends with 'e'.            -------------> select * from Customers where last_name like '%e';
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ IS NULL
Q1ï¸âƒ£5ï¸âƒ£ Find customers whose age is NULL.                           -------------> select * from Customers where age is null;

Q1ï¸âƒ£6ï¸âƒ£ Find shippings where status is NULL.                        -------------> select * from Shippings where status is null;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ INTERVIEW-FOCUSED TASKS
Q1ï¸âƒ£7ï¸âƒ£ Count total rows using COUNT(*) from Customers.             -------------> select count(*) from Customers;

Q1ï¸âƒ£8ï¸âƒ£ Count only non-NULL ages using COUNT(column).               -------------> select count(age) from Customers where age is not null;
 
Q1ï¸âƒ£9ï¸âƒ£ Find the average order amount but include only orders above 300. --------> select avg(amount) from Orders where amount>300;

Q2ï¸âƒ£0ï¸âƒ£ Find the maximum age among customers from USA and UK.       -------------> select max(age) from Customers where country in ('USA','UK');
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BASIC GROUP BY
Q1ï¸âƒ£ Display country-wise customer count.                                     -------------> select country,count(*) from Customers group by country;

Q2ï¸âƒ£ Display age-wise customer count.                                         -------------> select age,count(*) from Customers group by age;

Q3ï¸âƒ£ Display item-wise order count.                                           -------------> select item,count(*) from Orders group by item;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ GROUP BY WITH WHERE
Q4ï¸âƒ£ Count customers from USA and UK, grouped by country.                     -------------> select country,count(*) from Customers where country in ('USA','UK') group by country;

Q5ï¸âƒ£ Display order count per item where amount is greater than 300.           -------------> select item,count(*) from Orders where amount>300 group by item;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ GROUP BY WITH HAVING
Q6ï¸âƒ£ Display countries having more than 1 customer.                           -------------> select country from Customers group by country having count(*)>1;

Q7ï¸âƒ£ Display items having total order amount greater than 500.                -------------> select item,sum(amount) from Orders group by item having sum(amount)>500 ;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ GROUP BY MULTIPLE COLUMNS
Q8ï¸âƒ£ Display country-wise and age-wise customer count.                        -------------> select country,age,count(*) from Customers group by country,age; 

Q9ï¸âƒ£ Display item-wise and customer-wise order count.                         -------------> select item,customer_id,count(*) from Orders group by item,customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ GROUP BY WITH AGGREGATE FUNCTIONS
QðŸ”Ÿ Display customer-wise total order amount.                                -------------> select customer_id,avg(amount) from Orders group by customer_id;

Q1ï¸âƒ£1ï¸âƒ£ Display country-wise average customer age.                             -------------> select country,avg(age) from Customers group by country;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ HAVING (INTERVIEW FOCUS)
Q1ï¸âƒ£2ï¸âƒ£ Display customers whose total order amount is greater than 500.         -------------> select item,sum(amount) from Orders group by item having sum(amount)>500 ;

Q1ï¸âƒ£3ï¸âƒ£ Display items having more than 1 order.                                 -------------> select item,count(item) from Orders group by item having count(item)>1;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ WHERE vs HAVING (COMBINED)
Q1ï¸âƒ£4ï¸âƒ£ Display country-wise customer count, only for customers above age 22.   -------------> select country,count(country) from Customers where age>22 group by country;

Q1ï¸âƒ£5ï¸âƒ£ Display countries having average age greater than 25.                   -------------> select country from Customers group by country having avg(age)>25; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ INNER JOIN
Q1ï¸âƒ£ Display customer first name, item, and amount for customers who have placed orders. -------------> select c.first_name,o.item,o.amount from Customers c inner join Orders o on c.customer_id=o.customer_id;

Q2ï¸âƒ£ Display all order details along with customer country.                              -------------> select o.item,o.amount,c.country from Customers c inner join Orders o on c.customer_id=o.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ LEFT JOIN
Q3ï¸âƒ£ Display all customers and their orders, including customers with no orders.         -------------> select c.first_name,c.last_name,c.age,c.country,o.item,o.amount from Customers c left join Orders o on c.customer_id=o.customer_id;

Q4ï¸âƒ£ Find customers who have not placed any orders.                                      -------------> select c.first_name,c.last_name,c.age,c.country,o.item,o.amount from Customers c left join Orders o on c.customer_id=o.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ RIGHT JOIN
Q5ï¸âƒ£ Display all orders, including those without matching customer details.              -------------> SELECT o.item,o.amount, c.first_name, c.last_name,c.age,c.countryFROM Orders o right join Customers con c.customer_id=o.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ FULL JOIN
Q6ï¸âƒ£ Display all customers and all orders, including unmatched records.                  -------------> SELECT c.first_name, c.last_name,c.age,c.country,o.item,o.amountFROM  Customers cfull join Orders oon c.customer_id=o.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ SELF JOIN
Q7ï¸âƒ£ Display pairs of customers from the same country.                                   -------------> SELECT c1.first_name,c2.countryFROM  Customers c1join Customers c2on c1.country=c2.countryand c1.customer_id<>c2.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ CROSS JOIN
Q8ï¸âƒ£ Display all possible combinations of customers and order items.                     -------------> SELECT c.first_name,o.itemFROM  Customers ccross join Orders o;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ REAL-WORLD JOIN SCENARIOS
Q9ï¸âƒ£ Display customers along with their shipping status.                                 -------------> select c.customer_id,c.first_name,last_name,c.age,c.country,s.status from Customers cinner join Shippings son c.customer_id = s.customer order by c.customer_id asc;

Q1ï¸âƒ£0ï¸âƒ£ Find customers whose orders are not yet delivered.                               -------------> select c.customer_id,c.first_name,last_name,c.age,c.country,s.status from Customers cinner join Shippings son c.customer_id = s.customer where status='Pending' order by c.customer_id asc;

Q1ï¸âƒ£1ï¸âƒ£ Find orders that do not have any shipping details.                               -------------> SELECT o.order_id, o.item, o.amountFROM Orders oLEFT JOIN Shippings sON o.customer_id = s.customerWHERE s.shipping_id IS not NULL;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ MULTI-TABLE JOIN (INTERVIEW FAVORITE)
Q1ï¸âƒ£2ï¸âƒ£ Display customer name, item, amount, and shipping status.                        -------------> SELECT c.first_name, c.last_name,o.item, o.amount,s.status FROM Customers c inner JOIN Orders o ON c.customer_id = o.customer_id left JOIN Shippings s ON c.customer_id = s.customer;

Q1ï¸âƒ£3ï¸âƒ£ Display total order amount per customer along with shipping status.              -------------> SELECT c.customer_id,c.first_name,c.last_name,SUM(o.amount) AS total_order_amount,s.status FROM Customers c INNER JOIN Orders oON c.customer_id = o.customer_id LEFT JOIN Shippings s ON c.customer_id = s.customer GROUP BY c.customer_id,c.first_name,c.last_name,s.status;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ðŸ”¹ SUBQUERY:
LEVEL 1 TASKS (Single-Value)
Q1ï¸âƒ£ Find orders whose amount is greater than the average order amount.                   -------------> select item,amount from Orders where amount>(select avg(amount) from Orders);

Q2ï¸âƒ£ Find orders that have the maximum order amount.                                      -------------> select item,amount from Orders where amount=(select max(amount) from Orders); 

Q3ï¸âƒ£ Find orders that have the minimum order amount.                                      -------------> select item,amount from Orders where amount=(select min(amount) from Orders);
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 2 TASKS (IN)
Q4ï¸âƒ£ Find customers who placed orders                                                     -------------> select first_name,last_name from Customers where customer_id in (select customer_id from Orders order by customer_id asc) order by customer_id asc;                                                

Q5ï¸âƒ£ Find customers who did not place orders                                              -------------> select first_name,last_name from Customers where customer_id not in (select customer_id from Orders order by customer_id asc) order by customer_id asc;

Q7ï¸âƒ£ Find customers who have shipping records.                                            -------------> select first_name,last_name from Customers where customer_id in (select customer from Shippings order by customer asc) order by customer_id asc;

Q8ï¸âƒ£ Find customers who do not have any shipping records.                                 -------------> select first_name,last_name from Customers where customer_id not in (select customer from Shippings order by customer asc) order by customer_id asc;

Q9ï¸âƒ£ Find orders placed by customers from USA or UK (use subquery).                       -------------> select order_id,item,amount from Orders where customer_id in(select customer_id from Customers where country in('USA','UK'));
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 3 â€“ EXISTS / NOT EXISTS
(Focus on existence, not values)
QðŸ”Ÿ Find customers who have at least one order using EXISTS.                              -------------> select * from Customers c where exists (select * from Orders o where c.customer_id=o.customer_id);

Q1ï¸âƒ£1ï¸âƒ£ Find customers who have no orders using NOT EXISTS.                                 -------------> select * from Customers c where not exists (select * from Orders o where c.customer_id=o.customer_id);

Q1ï¸âƒ£2ï¸âƒ£ Find customers who have shipping details using EXISTS.                              -------------> select * from Customers c where exists (select * from Shippings s where c.customer_id=s.customer);

Q1ï¸âƒ£3ï¸âƒ£ Find customers who do not have shipping details using NOT EXISTS.                   -------------> select * from Customers c where not exists (select * from Shippings s where c.customer_id=s.customer);
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 4 â€“ Correlated Subqueries
(Inner query depends on outer query)
1ï¸âƒ£4ï¸âƒ£ Find customers whose age is greater than the average age of customers from the same country.                   -------------> select * from Customers c1 where age > (select avg(age) from Customers c2 where c2.country=c1.country); 

1ï¸âƒ£5ï¸âƒ£ Find customers who placed orders with an amount greater than the average order amount of that same customer.   -------------> select * from Customers c join Orders o on o.customer_id=c.customer_id where o.amount>(select avg(amount) from Orders o1 where o1.customer_id=c.customer_id );

1ï¸âƒ£6ï¸âƒ£ Find the highest order amount per customer using a correlated subquery.                                        -------------> select * from customers c join Orders o on o.customer_id=c.customer_id where o.amount=(select max(amount) from Orders o1 where o1.customer_id=c.customer_id);

1ï¸âƒ£7ï¸âƒ£ Find customers whose order amount equals the maximum order amount of that customer.                            -------------> select * from Customers c join Orders o on o.customer_id=c.customer_id where o.amount = (select max(amount) from Orders o2 where o2.customer_id=c.customer_id);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 1 â€“ SINGLE VALUE SUBQUERY
(Scalar subquery â†’ returns one value)
1ï¸âƒ£ Find customers who placed orders above the average order amount.                                                  -------------> select * from customers c join Orders o on o.customer_id=c.customer_id where o.amount=(select max(amount) from Orders o1 where o1.customer_id=c.customer_id);

2ï¸âƒ£ Find orders having the maximum amount.                                                                            -------------> select * from Orders where amount >(select max(amount) from Orders);

3ï¸âƒ£ Find orders having the minimum amount.                                                                            -------------> select * from Orders where amount <(select max(amount) from Orders);

4ï¸âƒ£ Find customers whose age is greater than the average age of all customers.                                        -------------> select * from Customers where age > (select avg(age) from Customers);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 2 â€“ IN SUBQUERY
(Subquery returns multiple values)
5ï¸âƒ£ Find customers who placed at least one order.                                                                     -------------> select * from Customers c where customer_id in(select customer_id from Orders);

6ï¸âƒ£ Find customers who did not place any orders.                                                                      -------------> select * from Customers c where customer_id not in(select customer_id from Orders);

7ï¸âƒ£ Find customers who have shipping records.                                                                         -------------> select * from Customers c where customer_id in(select customer from Shippings);

8ï¸âƒ£ Find orders placed by customers from USA or UK.                                                                   -------------> select * from Customers c where customer_id not in(select customer from Shippings);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 3 â€“ EXISTS / NOT EXISTS
(Checks presence, not values)
9ï¸âƒ£ Find customers who have orders.                                                                                   -------------> select * from Customers c where exists (select * from Orders o where o.customer_id=c.customer_id);

ðŸ”Ÿ Find customers who have no orders.                                                                                -------------> select * from Customers c where not exists (select * from Orders o where o.customer_id=c.customer_id);

1ï¸âƒ£1ï¸âƒ£ Find customers who have shipping details.                                                                      -------------> select * from Customers where exists (select * from Shippings s where s.customer_id=c.customer_id);

1ï¸âƒ£2ï¸âƒ£ Find orders that do not have shipping details.                                                                 -------------> select * from Customers where exists (select * from Shippings s where s.customer_id=c.customer_id);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
LEVEL 4 â€“ CORRELATED SUBQUERIES (MOST IMPORTANT)
(Subquery depends on outer query)
1ï¸âƒ£3ï¸âƒ£ Find customers whose order amount is greater than the average order amount of that same customer.              -------------> select * from Customers c join Orders o on o.customer_id = c.customer_id where o.amount>(select avg(amount) from orders o1 where o1.customer_id=c.customer_id);

1ï¸âƒ£4ï¸âƒ£ Find customers whose order amount is equal to the maximum order amount of that customer.                       -------------> select * from Customers c join Orders o on o.customer_id = c.customer_id where o.amount=(select max(amount) from orders o1 where o1.customer_id=c.customer_id);

1ï¸âƒ£5ï¸âƒ£ Find customers who placed their highest order.                                                                 -------------> select * from Customers c join Orders o on o.customer_id = c.customer_id where o.amount=(select max(amount) from orders o1 where o1.customer_id=c.customer_id);

1ï¸âƒ£6ï¸âƒ£ Find customers who placed orders greater than their minimum order amount.                                      -------------> select * from Customers c join Orders o on o.customer_id = c.customer_id where o.amount>(select min(amount) from orders o1 where o1.customer_id=c.customer_id);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INTERVIEW SCENARIOS (LOGIC CHECK)
1ï¸âƒ£7ï¸âƒ£ Find customers who placed more orders than the average number of orders per customer.                          -------------> select c.customer_id,c.first_name,c.last_name,c.age,c.country,count(o.order_id) as total_orders from Customers c join Orders o on o.customer_id=c.customer_id group by c.customer_id, c.first_name, c.last_name, c.age, c.country having count(o.order_id)>(select avg(order_count) from (select count(*) as order_count from Orders group by customer_id));

1ï¸âƒ£8ï¸âƒ£ Find customers whose total order amount is greater than the average total order amount.                        -------------> select c.customer_id,c.first_name,c.last_name,o.amount as total_order_amount from Customers c join Orders o on o.customer_id=c.customer_id where o.amount>(select avg(sumoforders) from(select sum(amount) as sumofordersfrom Orders group by customer_id));

1ï¸âƒ£9ï¸âƒ£ Find customers who placed orders but do not have shipping status.                                              -------------> select * from Customers c inner join Orders o on o.customer_id=c.customer_id left join Shippings s on s.customer = o.customer_id where status is null;

2ï¸âƒ£0ï¸âƒ£ Find customers whose latest order amount is greater than their first order amount.                             -------------> SELECT c.customer_id,c.first_name,c.last_nameFROM Customers c JOIN Orders o ON o.customer_id = c.customer_id WHERE o.order_id = (SELECT MAX(o1.order_id) FROM Orders o1 WHERE o1.customer_id = c.customer_id) AND o.amount > (SELECT o2.amount FROM Orders o2 WHERE o2.customer_id = c.customer_id AND o2.order_id = ( SELECT MIN(o3.order_id) FROM Orders o3 WHERE o3.customer_id = c.customer_id));
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BASIC LEVEL
1ï¸âƒ£ Find customers who placed at least one order.                                                                    -------------> select * from Customers c where exists (select customer_id from Orders o where c.customer_id=o.customer_id);  

2ï¸âƒ£ Find customers who did not place any orders.                                                                     -------------> select * from Customers c where not exists (select customer_id from Orders o where c.customer_id=o.customer_id); 

3ï¸âƒ£ Find orders whose amount is greater than the average order amount.                                               -------------> select * from Orders where amount > (select avg(amount) from Orders);

4ï¸âƒ£ Find the order with the maximum amount.                                                                          -------------> select * from Orders where amount = (select max(amount) from Orders);

5ï¸âƒ£ Find customers who have more than one order.                                                                     -------------> SELECT c.customer_id,c.first_name,c.last_name,COUNT(o.order_id) AS total_orders FROM Customers c JOIN Orders o ON o.customer_id = c.customer_id GROUP BY c.customer_id,c.first_name,c.last_name HAVING COUNT(o.order_id) > 1;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INTERMEDIATE LEVEL
6ï¸âƒ£ Find customers whose total order amount is greater than the average total order amount.                          -------------> select c.customer_id,c.first_name,c.last_name,o.amount from Customers c join Orders o on o.customer_id=c.customer_id where o.amount>(select avg(sumoforders) from (select sum(amount) as sumoforders from Orders group by customer_id));

7ï¸âƒ£ Find customers who placed orders above the average order amount of all orders.                                   -------------> select c.customer_id,c.first_name,c.last_name from Customers c join Orders o on o.customer_id=c.customer_id where o.amount>(select avg(amount) from Orders);

8ï¸âƒ£ Find customers who placed orders but do not have any shipping status.                                            -------------> select * from Customers c inner join Orders o on o.customer_id=c.customer_id left join Shippings s on s.customer = o.customer_idwhere status is null;

9ï¸âƒ£ Find customers who have shipping records but no orders.                                                          -------------> select * from Customers c inner join Shippings s on s.customer=c.customer_id left join Orders o on o.customer_id = s.customer where o.order_id is null;

ðŸ”Ÿ Find customers whose order amount equals the maximum order amount.                                               -------------> select c.customer_id,c.first_name,c.last_name from Customers c join Orders o on o.customer_id=c.customer_id where o.amount=(select max(amount) from Orders);
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ADVANCED LEVEL (LOGIC HEAVY)
1ï¸âƒ£1ï¸âƒ£ Find the highest order amount placed by each customer.                                                         -------------> select c.customer_id,c.first_name,c.last_name,max(o.amount)from Customers cjoin Orders oon o.customer_id=c.customer_idgroup by o.customer_id,c.first_name,c.last_name

1ï¸âƒ£2ï¸âƒ£ Find customers whose order amount is greater than their own average order amount.                              ------------->

1ï¸âƒ£3ï¸âƒ£ Find customers whose order amount is equal to the maximum order amount of that customer.                       ------------->

1ï¸âƒ£4ï¸âƒ£ Find customers who placed more orders than the average number of orders per customer.                          ------------->

1ï¸âƒ£5ï¸âƒ£ Find customers whose total order amount is less than the maximum total order amount among all customers.       ------------->
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
